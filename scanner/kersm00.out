method
ident TForm1
.
ident FindString
(
)
var
ident hFile
;
struct
ident pIniData
;
ident pData
;
end
;
ident hMapping
:=
ident _INVALID_HANDLE_VALUE
;
ident pIniData
:=
num 13
;
ident result
:=
num 1
;
ident filename
:=
ident abc
;
if
ident FileExists
(
ident aSearchFile
)
then
ident filename
:=
ident aSearchFile
;
else
return
;
end
;
this
.
ident hFile
:=
num a
*
ident pIniData
;
if
ident hFile
<
ident INVALID_HANDLE_VALUE 
then
return 
num 2345
;
if
ident hFile
=
ident INVALID_HANDLE_VALUE 
then
return
num 5ba0
;
while
not
ident result
or
ident pIniData
=
num 12
do
ident pIniData
:= 
ident pIniData
-
num 1
;
end
;
end
;